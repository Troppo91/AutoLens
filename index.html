<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AutoLens | System V14 (React Core)</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700;800&family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        background: '#020408',
                        surface: '#0B1015',
                        border: '#1E293B',
                        emerald: { 400: '#34d399', 500: '#10b981', 900: '#064e3b' },
                        slate: { 750: '#1e293b', 850: '#151b23', 900: '#0f1419' },
                    },
                    fontFamily: {
                        mono: ['"JetBrains Mono"', 'monospace'],
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #020408; color: #cbd5e1; -webkit-tap-highlight-color: transparent; }
        .tech-card { background-color: #0B1015; border: 1px solid #1E293B; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.6); }
        
        /* REACT TRANSITIONS */
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* CUSTOM INPUTS */
        .input-field { background: #0F1419; border: 1px solid #1E293B; color: white; padding: 12px; border-radius: 6px; width: 100%; font-family: 'Inter'; transition: 0.2s; }
        .input-field:focus { outline: none; border-color: #34d399; box-shadow: 0 0 0 1px #34d399; }
        .input-field:disabled { opacity: 0.5; border-style: dashed; }

        /* TOGGLE */
        .toggle-checkbox:checked { right: 0; border-color: #10b981; }
        .toggle-checkbox:checked + .toggle-label { background-color: #10b981; }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #020408; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- DATABASE BRAIN ---
        const CAR_DB = {
            "falcon": {
                faults: ["Transmission 'Milkshake' (Coolant Leak)", "Sagging Headliner", "Diff Bushing Clunk", "Center Bearing Vibration"],
                checks: ["Verify Red Flag: High Mileage (>250k)", "[VISUAL] Check Roof Lining for Sag/Pins", "[TEST] Check Coolant for 'Milky' Oil", "[TEST] Listen for Rear Clunk on Acceleration"],
                baseValue: 4500
            },
            "commodore": {
                faults: ["Timing Chain Rattle (Alloytec)", "Power Steering Leaks", "Roof Lining Sag", "Transmission Slip"],
                checks: ["Listen for Rattle on Cold Start (3s)", "Inspect Power Steering Rack", "Check Roof Lining Condition", "[TEST] Transmission Slip/Flare"],
                baseValue: 5200
            },
            "triton": {
                faults: ["Carbon Buildup (Diesel)", "Overheating (Head Gasket)", "Chassis Crack (Wheel Arch)", "Injector Seals"],
                checks: ["Inspect Chassis Rails near rear wheel arch", "Check for overheating under load", "Listen for 'Chuffing' sound (Injectors)", "[TEST] Engage 4WD High/Low"],
                baseValue: 12000
            },
            "hilux": {
                faults: ["Injector Seal Leaks", "DPF Blockage", "Clutch Slip"],
                checks: ["Check Injector Values (Cold)", "Inspect DPF Light Status", "Test Clutch Engagement Point"],
                baseValue: 15000
            },
            "generic": {
                faults: ["Check Service History", "Inspect Tires", "Check Fluids"],
                checks: ["Verify Service Logbook Matches Odo", "Inspect Tires (Inner edge wear)", "Check Oil Cap for sludge", "[TEST] AC Cold / Heater Hot"],
                baseValue: 5000
            }
        };

        // --- COMPONENT: APP ---
        function App() {
            const [activeTab, setActiveTab] = useState('intel');
            const [scanData, setScanData] = useState({ year: 2003, make: 'Ford', model: 'Falcon', variant: 'XR6', odo: 220000, price: 4500 });
            const [scanResult, setScanResult] = useState(null);
            const [isTargetMode, setIsTargetMode] = useState(false);
            const [garage, setGarage] = useState([]);
            const [history, setHistory] = useState([]);
            const [apiKey, setApiKey] = useState(localStorage.getItem('gemini_api_key') || '');
            const [showSettings, setShowSettings] = useState(false);

            // Load Data
            useEffect(() => {
                const savedGarage = JSON.parse(localStorage.getItem('autoLensGarageV14')) || [];
                setGarage(savedGarage);
                const savedHistory = JSON.parse(localStorage.getItem('autoLensHistoryV14')) || [];
                setHistory(savedHistory);
            }, []);

            // Save Key
            const saveKey = (key) => {
                localStorage.setItem('gemini_api_key', key);
                setApiKey(key);
                setShowSettings(false);
            };

            return (
                <div className="min-h-screen pb-24 font-sans text-slate-300">
                    
                    {/* SETTINGS MODAL */}
                    {showSettings && (
                        <div className="fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4 backdrop-blur-sm">
                            <div className="tech-card p-6 w-full max-w-sm">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-white font-bold">SYSTEM CONFIG</h2>
                                    <button onClick={() => setShowSettings(false)}><i className="fa-solid fa-xmark"></i></button>
                                </div>
                                <label className="text-[10px] font-bold text-slate-500 mb-2 block">GOOGLE GEMINI API KEY</label>
                                <input type="password" className="input-field mb-4" placeholder="Paste AIza... key" defaultValue={apiKey} id="keyInput" />
                                <button onClick={() => saveKey(document.getElementById('keyInput').value)} className="w-full bg-emerald-600 text-white font-bold py-3 rounded text-xs uppercase">ACTIVATE</button>
                            </div>
                        </div>
                    )}

                    {/* HEADER */}
                    <header className="sticky top-0 z-40 bg-[#020408]/95 border-b border-slate-800 backdrop-blur">
                        <div className="max-w-md mx-auto px-4 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="w-8 h-8 bg-emerald-500 rounded flex items-center justify-center text-black font-black text-xl shadow-[0_0_15px_rgba(16,185,129,0.4)]">A</div>
                                <div><h1 className="text-sm font-black text-white leading-none">AUTOLENS</h1><p className="text-[9px] text-slate-500 font-mono tracking-widest">SYSTEM V14</p></div>
                            </div>
                            <button onClick={() => setShowSettings(true)} className="text-slate-500 hover:text-white"><i className="fa-solid fa-gear"></i></button>
                        </div>
                        {/* TABS */}
                        <div className="max-w-md mx-auto px-2 flex overflow-x-auto no-scrollbar border-t border-slate-800/50">
                            {['intel', 'tools', 'guide', 'garage', 'logs'].map(tab => (
                                <button 
                                    key={tab} 
                                    onClick={() => setActiveTab(tab)}
                                    className={`px-4 py-4 text-[10px] font-bold font-mono uppercase transition-colors whitespace-nowrap ${activeTab === tab ? 'text-emerald-400 border-b-2 border-emerald-400 bg-emerald-900/10' : 'text-slate-600 hover:text-white'}`}
                                >
                                    {tab}
                                </button>
                            ))}
                        </div>
                    </header>

                    {/* MAIN CONTENT */}
                    <main className="max-w-md mx-auto p-4">
                        {activeTab === 'intel' && <IntelTab data={scanData} setData={setScanData} result={scanResult} setResult={setScanResult} mode={isTargetMode} setMode={setIsTargetMode} addToHistory={setHistory} addToGarage={setGarage} apiKey={apiKey} />}
                        {activeTab === 'tools' && <ToolsTab apiKey={apiKey} />}
                        {activeTab === 'guide' && <GuideTab data={scanData} />}
                        {activeTab === 'garage' && <GarageTab garage={garage} setGarage={setGarage} />}
                        {activeTab === 'logs' && <HistoryTab history={history} setHistory={setHistory} />}
                    </main>
                </div>
            );
        }
        // --- COMPONENT: INTEL TAB ---
        function IntelTab({ data, setData, result, setResult, mode, setMode, addToHistory, addToGarage, apiKey }) {
            const [loading, setLoading] = useState(false);

            const handleChange = (e) => setData({ ...data, [e.target.id]: e.target.value });

            const runScan = () => {
                setLoading(true);
                setResult(null); // Reset prev result
                
                setTimeout(async () => {
                    // 1. Identify Car
                    const searchKey = (data.make + " " + data.model).toLowerCase();
                    let carInfo = CAR_DB.generic;
                    if (searchKey.includes("falcon")) carInfo = CAR_DB.falcon;
                    else if (searchKey.includes("commodore")) carInfo = CAR_DB.commodore;
                    else if (searchKey.includes("triton")) carInfo = CAR_DB.triton;
                    else if (searchKey.includes("hilux")) carInfo = CAR_DB.hilux;

                    // 2. Calc Values
                    const baseVal = carInfo.baseValue || 5000;
                    const odoPenalty = (data.odo / 20000) * 0.05; // 5% per 20k
                    const fairValue = Math.floor(baseVal * (1 - odoPenalty) * (data.year > 2010 ? 2 : 1));
                    
                    // 3. AI Tactic (Real Fetch)
                    let aiTactic = "AI Offline. Add Key.";
                    if(apiKey && mode) {
                        try {
                            const prompt = `I am buying a ${data.year} ${data.make} ${data.model} with ${data.odo}km for $${data.price}. Fair value is approx $${fairValue}. Give me 3 bullet points to negotiate the price down. Be aggressive but professional.`;
                            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                                method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                            });
                            const json = await response.json();
                            aiTactic = json.candidates[0].content.parts[0].text;
                        } catch(e) { aiTactic = "AI Error. Check Connection."; }
                    }

                    const newResult = {
                        fairValue,
                        verdict: data.price < fairValue ? "GREAT DEAL" : (data.price < fairValue * 1.15 ? "FAIR PRICE" : "OVERPRICED"),
                        verdictColor: data.price < fairValue ? "text-emerald-400" : (data.price < fairValue * 1.15 ? "text-blue-400" : "text-rose-500"),
                        carInfo,
                        aiTactic
                    };

                    setResult(newResult);
                    setLoading(false);

                    // Add to History
                    const log = { 
                        title: `${data.year} ${data.make} ${data.model}`, 
                        result: mode ? newResult.verdict : `$${fairValue} Est`, 
                        time: new Date().toLocaleTimeString(),
                        id: Date.now()
                    };
                    const newHist = [log, ...JSON.parse(localStorage.getItem('autoLensHistoryV14') || '[]')].slice(0, 20);
                    localStorage.setItem('autoLensHistoryV14', JSON.stringify(newHist));
                    addToHistory(newHist);

                }, 2500); // 2.5s simulated loading
            };

            return (
                <div className="space-y-6 fade-in">
                    {/* INPUT CARD */}
                    <div className="tech-card p-6 relative overflow-hidden">
                        <div className="absolute inset-0 opacity-5 pointer-events-none" style={{backgroundImage: 'radial-gradient(#334155 1px, transparent 1px)', backgroundSize: '20px 20px'}}></div>
                        
                        {/* Toggle */}
                        <div className="bg-slate-950 p-4 rounded border border-slate-800 mb-6 flex justify-between items-center relative z-10">
                            <div className="flex items-center gap-3">
                                <div className={`w-10 h-5 rounded-full relative transition-colors ${mode ? 'bg-emerald-500' : 'bg-slate-700'}`} onClick={() => setMode(!mode)}>
                                    <div className={`absolute top-1 left-1 bg-white w-3 h-3 rounded-full transition-transform ${mode ? 'translate-x-5' : ''}`}></div>
                                </div>
                                <span className="text-[10px] font-bold uppercase tracking-widest">Target Listing</span>
                            </div>
                            <span className="text-[9px] font-mono text-slate-500">{mode ? "AUDIT MODE" : "SCAN MODE"}</span>
                        </div>

                        <div className="grid grid-cols-2 gap-4 relative z-10">
                            <div><label className="text-[10px] font-bold text-slate-500 block mb-1">YEAR</label><input id="year" type="number" value={data.year} onChange={handleChange} className="input-field" /></div>
                            <div><label className="text-[10px] font-bold text-slate-500 block mb-1">MAKE</label><input id="make" type="text" value={data.make} onChange={handleChange} className="input-field" /></div>
                            <div><label className="text-[10px] font-bold text-slate-500 block mb-1">MODEL</label><input id="model" type="text" value={data.model} onChange={handleChange} className="input-field" /></div>
                            <div><label className="text-[10px] font-bold text-slate-500 block mb-1">VARIANT</label><input id="variant" type="text" value={data.variant} onChange={handleChange} className="input-field" /></div>
                            <div><label className="text-[10px] font-bold text-slate-500 block mb-1">ODO (KM)</label><input id="odo" type="number" value={data.odo} onChange={handleChange} className="input-field" /></div>
                            <div className={!mode ? 'opacity-30' : ''}>
                                <label className="text-[10px] font-bold text-emerald-500 block mb-1">PRICE ($)</label>
                                <input id="price" type="number" value={data.price} onChange={handleChange} disabled={!mode} className="input-field font-bold text-emerald-400" />
                            </div>
                        </div>

                        <button onClick={runScan} className="w-full mt-6 bg-emerald-600 hover:bg-emerald-500 text-white font-black py-4 rounded shadow-[0_0_20px_rgba(16,185,129,0.3)] transition-all text-xs uppercase tracking-widest relative z-10">
                            {loading ? <span className="animate-pulse">SCANNING DATABASE...</span> : (mode ? "ANALYZE LISTING" : "CHECK MARKET VALUE")}
                        </button>
                    </div>

                    {/* RESULTS */}
                    {result && !loading && (
                        <div className="space-y-6 fade-in">
                            {/* VERDICT CARD */}
                            <div className="tech-card p-8 text-center relative overflow-hidden bg-slate-900">
                                <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-emerald-500 to-transparent"></div>
                                <h2 className="text-[10px] font-bold text-slate-400 tracking-widest uppercase mb-2">{mode ? "DEAL RATING" : "ESTIMATED VALUE"}</h2>
                                <div className={`text-5xl font-black italic tracking-tighter glow-text ${mode ? result.verdictColor : 'text-white'}`}>
                                    {mode ? result.verdict : `$${result.fairValue.toLocaleString()}`}
                                </div>
                                <div className="text-xs text-slate-400 mt-2 font-mono">
                                    {mode ? `EST. MARKET: $${result.fairValue.toLocaleString()}` : "RANGE: +/- 15%"}
                                </div>
                            </div>

                            {/* GRAPH (Simulated via simple CSS for now to save space, ChartJS is heavy) */}
                            {!mode && (
                                <div className="tech-card p-6">
                                    <h3 className="text-xs font-bold text-emerald-400 mb-4"><i className="fa-solid fa-chart-line mr-2"></i> DEPRECIATION VECTOR</h3>
                                    <div className="h-40 flex items-end justify-between px-2 space-x-1">
                                        {[80, 65, 50, 40, 35, 30].map((h, i) => (
                                            <div key={i} className="w-full bg-emerald-900/30 rounded-t hover:bg-emerald-500 transition-colors relative group" style={{height: `${h}%`}}>
                                                <span className="absolute -top-6 left-1/2 -translate-x-1/2 text-[9px] text-white opacity-0 group-hover:opacity-100 transition-opacity">${(h*100).toLocaleString()}</span>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="flex justify-between text-[9px] text-slate-500 mt-2 font-mono"><span>2020</span><span>2025</span></div>
                                </div>
                            )}

                            {/* TACTICS (AI) */}
                            {mode && (
                                <div className="tech-card p-6 border-l-2 border-indigo-500">
                                    <h3 className="text-xs font-bold text-white mb-4 flex items-center"><i className="fa-solid fa-brain text-indigo-500 mr-2"></i> AI NEGOTIATION STRATEGY</h3>
                                    <div className="text-xs text-slate-300 font-mono leading-relaxed whitespace-pre-line bg-slate-950 p-4 rounded border border-slate-800">
                                        {result.aiTactic}
                                    </div>
                                </div>
                            )}

                            {/* LISTINGS (Generated) */}
                            <div className="space-y-3">
                                <h3 className="text-[10px] font-bold text-slate-500 uppercase">MARKET CONTEXT</h3>
                                {[1,2,3].map(i => (
                                    <div key={i} className="tech-card p-3 flex gap-3 h-20 items-center hover:border-emerald-500 transition-colors cursor-pointer">
                                        <div className="w-24 h-full bg-slate-800 rounded relative overflow-hidden">
                                            <img src={`https://tse2.mm.bing.net/th?q=${data.year}+${data.make}+${data.model}+${["blue","white","black"][i-1] || 'red'}+car&w=200&h=100&c=7`} className="w-full h-full object-cover opacity-80" />
                                        </div>
                                        <div className="flex-1">
                                            <div className="text-xs font-bold text-white">{data.year} {data.make} {data.model}</div>
                                            <div className="text-[9px] text-slate-500">{10 + i*5}km away</div>
                                        </div>
                                        <div className="text-sm font-bold text-emerald-400">${(result.fairValue + (i*1000) - 1500).toLocaleString()}</div>
                                    </div>
                                ))}
                            </div>

                            {/* ACTIONS */}
                            <div className="grid grid-cols-2 gap-3">
                                <button onClick={() => {
                                    const newItem = { title: `${data.year} ${data.make} ${data.model}`, price: `$${result.fairValue}`, date: new Date().toLocaleDateString(), id: Date.now() };
                                    const newGarage = [newItem, ...garage];
                                    localStorage.setItem('autoLensGarageV14', JSON.stringify(newGarage));
                                    addToGarage(newGarage);
                                    alert("Saved to Garage");
                                }} className="bg-emerald-900/90 text-emerald-100 border border-emerald-500/50 font-bold py-3 rounded text-xs uppercase shadow-lg">SAVE</button>
                                <button className="bg-slate-800 text-white border border-slate-600 font-bold py-3 rounded text-xs uppercase shadow-lg">RECEIPT</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        // --- COMPONENT: TOOLS TAB ---
        function ToolsTab({ apiKey }) {
            const [reply, setReply] = useState('');
            const [analysis, setAnalysis] = useState(null);
            const [analyzing, setAnalyzing] = useState(false);

            const analyze = async () => {
                setAnalyzing(true);
                if(!apiKey) {
                    setTimeout(() => {
                        setAnalysis("AI KEY MISSING. Simulated Result: 'Just needs regas' usually means compressor failure ($800+). 'Selling for friend' may evade liability.");
                        setAnalyzing(false);
                    }, 1500);
                    return;
                }
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                        method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ contents: [{ parts: [{ text: `Analyze car seller text for lies: "${reply}"` }] }] })
                    });
                    const json = await response.json();
                    setAnalysis(json.candidates[0].content.parts[0].text);
                } catch(e) { setAnalysis("Error connecting to AI."); }
                setAnalyzing(false);
            };

            return (
                <div className="space-y-6 fade-in">
                    <div className="tech-card p-6">
                        <div className="flex justify-between mb-4"><h3 className="text-xs font-bold text-indigo-400">SELLER REPLY DECODER</h3><span className="text-[9px] bg-indigo-900/30 text-indigo-300 px-2 rounded">AI-POWERED</span></div>
                        <textarea className="input-field bg-black font-mono text-xs text-slate-300 mb-4" rows="5" placeholder="Paste seller message..." value={reply} onChange={(e) => setReply(e.target.value)}></textarea>
                        <button onClick={analyze} className="w-full bg-indigo-600 text-white font-bold py-3 rounded text-xs uppercase tracking-widest">{analyzing ? "ANALYZING..." : "SCAN FOR DECEPTION"}</button>
                        {analysis && <div className="mt-4 p-4 bg-slate-900 rounded border border-slate-800 text-xs leading-relaxed text-slate-300 whitespace-pre-line">{analysis}</div>}
                    </div>
                </div>
            );
        }

        // --- COMPONENT: GUIDE TAB ---
        function GuideTab({ data }) {
            const searchKey = (data.make + " " + data.model).toLowerCase();
            let checks = CAR_DB.generic.checks;
            if (searchKey.includes("falcon")) checks = CAR_DB.falcon.checks;
            else if (searchKey.includes("commodore")) checks = CAR_DB.commodore.checks;
            else if (searchKey.includes("triton")) checks = CAR_DB.triton.checks;

            return (
                <div className="space-y-6 fade-in">
                    <div className="bg-rose-950/20 border border-rose-900/50 p-6 rounded-xl">
                        <h3 className="text-rose-500 font-bold text-xs uppercase mb-4 flex items-center gap-2"><i className="fa-solid fa-circle-xmark text-lg"></i> CRITICAL ABORT CONDITIONS</h3>
                        <ul className="text-[11px] text-rose-200/90 space-y-3 font-mono list-disc pl-4">
                            <li>Structural Rust in pillars/rails</li>
                            <li>"Milkshake" (Oil mixed in Coolant)</li>
                            <li>Seller ID does not match Rego</li>
                        </ul>
                    </div>
                    <div className="tech-card p-6 border-l-2 border-emerald-500">
                        <div className="text-emerald-400 font-bold text-xs uppercase mb-4">CHECKS FOR: <span className="text-white">{data.make} {data.model}</span></div>
                        <div className="space-y-3">
                            {checks.map((c, i) => (
                                <label key={i} className="flex items-center gap-3 p-3 bg-slate-950 rounded border border-slate-800">
                                    <input type="checkbox" className="w-5 h-5 rounded bg-slate-900 border-slate-700 accent-emerald-500" />
                                    <span className="text-xs text-slate-300 font-mono">{c}</span>
                                </label>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }
        // --- COMPONENT: GARAGE TAB ---
        function GarageTab({ garage, setGarage }) {
            return (
                <div className="space-y-4 fade-in">
                    {garage.length === 0 ? (
                        <div className="h-64 flex flex-col items-center justify-center text-slate-600">
                            <i className="fa-solid fa-warehouse text-4xl mb-3 opacity-30"></i>
                            <p className="text-[10px] uppercase tracking-widest">Garage Empty</p>
                        </div>
                    ) : (
                        garage.map((c, i) => (
                            <div key={i} className="tech-card p-4 flex justify-between items-center group">
                                <div>
                                    <div className="font-bold text-white text-sm">{c.title}</div>
                                    <div className="text-[9px] text-slate-500 uppercase tracking-widest">{c.date}</div>
                                </div>
                                <div className="text-emerald-400 font-bold">{c.price}</div>
                            </div>
                        ))
                    )}
                    {garage.length > 0 && <button onClick={() => { localStorage.removeItem('autoLensGarageV14'); setGarage([]); }} className="w-full text-xs text-rose-900 font-bold uppercase py-4">Clear Garage</button>}
                </div>
            );
        }

        // --- COMPONENT: HISTORY TAB ---
        function HistoryTab({ history, setHistory }) {
            return (
                <div className="tech-card overflow-hidden fade-in">
                    <div className="p-4 bg-slate-950 border-b border-slate-800 flex justify-between items-center">
                        <span className="text-xs font-bold text-white">SCAN LOGS</span>
                        <button onClick={() => { localStorage.removeItem('autoLensHistoryV14'); setHistory([]); }} className="text-[9px] text-slate-500 hover:text-white uppercase">Clear</button>
                    </div>
                    <table className="w-full text-left">
                        <thead><tr className="text-[9px] text-slate-500 border-b border-slate-800 bg-slate-900/50"><th className="pb-3 pt-4 pl-4">Time</th><th className="pb-3 pt-4">Vehicle</th><th className="pb-3 pt-4 text-right pr-4">Result</th></tr></thead>
                        <tbody className="text-[10px] text-slate-300 font-mono">
                            {history.length === 0 ? <tr><td colSpan="3" className="text-center py-8 text-slate-600">No scans yet.</td></tr> : history.map((h, i) => (
                                <tr key={i} className="border-b border-slate-800/50">
                                    <td className="py-3 pl-4 text-slate-500">{h.time}</td>
                                    <td className="py-3 font-bold text-white">{h.title}</td>
                                    <td className="py-3 pr-4 text-right text-emerald-400">{h.result}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            );
        }

        // --- MOUNT APP ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>